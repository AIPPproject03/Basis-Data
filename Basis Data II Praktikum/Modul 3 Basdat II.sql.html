<html>
<head>
<title>Modul 3 Basdat II.sql</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Modul 3 Basdat II.sql</font>
</center></td></tr></table>
<pre><span class="s0"># BY AIPPproject03</span>
<span class="s0"># Nama : A.Irwin Putra Pangesti</span>
<span class="s0"># NIM  : 223020503162</span>
<span class="s0">#  SOAL 1:</span>
<span class="s2">CREATE VIEW </span><span class="s1">ban_dunlop </span><span class="s2">AS</span>
    <span class="s2">SELECT </span><span class="s1">sp</span><span class="s3">.</span><span class="s1">ID_Sparepart</span><span class="s3">, </span><span class="s1">sp</span><span class="s3">.</span><span class="s1">Nama_Sparepart</span><span class="s3">, </span><span class="s1">sp</span><span class="s3">.</span><span class="s1">Stok</span><span class="s3">, </span><span class="s1">sp</span><span class="s3">.</span><span class="s1">Jenis_Sparepart</span><span class="s3">, </span><span class="s1">sp</span><span class="s3">.</span><span class="s1">Harga</span><span class="s3">, </span><span class="s1">ps</span><span class="s3">.</span><span class="s1">ID_Pembelian_Sparepart</span><span class="s3">, </span><span class="s1">ps</span><span class="s3">.</span><span class="s1">ID_Transaksi</span><span class="s3">, </span><span class="s1">ps</span><span class="s3">.</span><span class="s1">Jumlah_Beli</span>
    <span class="s2">FROM </span><span class="s1">Sparepart sp</span>
    <span class="s2">INNER JOIN </span><span class="s1">Pembelian_Sparepart ps </span><span class="s2">ON </span><span class="s1">sp</span><span class="s3">.</span><span class="s1">ID_Sparepart = ps</span><span class="s3">.</span><span class="s1">ID_Sparepart</span>
    <span class="s2">WHERE </span><span class="s1">sp</span><span class="s3">.</span><span class="s1">Nama_Sparepart = </span><span class="s4">'Ban' </span><span class="s2">AND </span><span class="s1">sp</span><span class="s3">.</span><span class="s1">Jenis_Sparepart = </span><span class="s4">'Kendaraan'</span><span class="s3">;</span>
<span class="s2">SELECT </span><span class="s1">* </span><span class="s2">FROM </span><span class="s1">ban_dunlop</span><span class="s3">;</span>

<span class="s0">#  SOAL 2:</span>
<span class="s2">CREATE VIEW </span><span class="s1">pemasukan_pegawai_service </span><span class="s2">AS</span>
    <span class="s2">SELECT </span><span class="s1">pg</span><span class="s3">.</span><span class="s1">ID_Pegawai</span><span class="s3">, </span><span class="s1">pg</span><span class="s3">.</span><span class="s1">Nama_Pegawai</span><span class="s3">, </span><span class="s1">sv</span><span class="s3">.</span><span class="s1">Nama_Service</span><span class="s3">, </span><span class="s1">sv</span><span class="s3">.</span><span class="s1">Harga</span><span class="s3">, </span><span class="s2">COUNT</span><span class="s3">(</span><span class="s1">ps</span><span class="s3">.</span><span class="s1">ID_Service</span><span class="s3">) </span><span class="s2">AS </span><span class="s1">Jumlah_Service</span><span class="s3">, </span><span class="s1">sv</span><span class="s3">.</span><span class="s1">Harga * </span><span class="s2">COUNT</span><span class="s3">(</span><span class="s1">ps</span><span class="s3">.</span><span class="s1">ID_Service</span><span class="s3">) </span><span class="s2">AS </span><span class="s1">Total_Pemasukan</span>
    <span class="s2">FROM </span><span class="s1">Pegawai pg</span>
    <span class="s2">INNER JOIN </span><span class="s1">Pembelian_Service ps </span><span class="s2">ON </span><span class="s1">pg</span><span class="s3">.</span><span class="s1">ID_Pegawai = ps</span><span class="s3">.</span><span class="s1">ID_Pegawai</span>
    <span class="s2">INNER JOIN </span><span class="s1">Service sv </span><span class="s2">ON </span><span class="s1">ps</span><span class="s3">.</span><span class="s1">ID_Service = sv</span><span class="s3">.</span><span class="s1">ID_Service</span>
    <span class="s2">WHERE </span><span class="s1">pg</span><span class="s3">.</span><span class="s1">ID_Jabatan = </span><span class="s4">'J003'</span>
    <span class="s2">GROUP BY </span><span class="s1">pg</span><span class="s3">.</span><span class="s1">ID_Pegawai</span><span class="s3">, </span><span class="s1">sv</span><span class="s3">.</span><span class="s1">ID_Service</span><span class="s3">;</span>
<span class="s2">SELECT </span><span class="s1">* </span><span class="s2">FROM </span><span class="s1">pemasukan_pegawai_service</span><span class="s3">;</span>

<span class="s0">#  SOAL 3:</span>
<span class="s2">CREATE VIEW </span><span class="s1">daftar_pegawai </span><span class="s2">AS</span>
    <span class="s2">SELECT </span><span class="s1">pg</span><span class="s3">.</span><span class="s1">ID_Pegawai</span><span class="s3">, </span><span class="s1">pg</span><span class="s3">.</span><span class="s1">ID_Jabatan</span><span class="s3">, </span><span class="s1">pg</span><span class="s3">.</span><span class="s1">Nama_Pegawai</span><span class="s3">, </span><span class="s1">pg</span><span class="s3">.</span><span class="s1">Alamat</span><span class="s3">, </span><span class="s1">pg</span><span class="s3">.</span><span class="s1">Username</span><span class="s3">, </span><span class="s1">pg</span><span class="s3">.</span><span class="s1">Password</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ID_Nomor</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">No_Telp</span>
    <span class="s2">FROM </span><span class="s1">Pegawai pg</span>
    <span class="s2">INNER JOIN </span><span class="s1">Nomor_Pegawai np </span><span class="s2">ON </span><span class="s1">pg</span><span class="s3">.</span><span class="s1">ID_Pegawai = np</span><span class="s3">.</span><span class="s1">ID_Pegawai</span><span class="s3">;</span>
<span class="s2">SELECT </span><span class="s1">* </span><span class="s2">FROM </span><span class="s1">daftar_pegawai</span><span class="s3">;</span>

<span class="s0">#  SOAL 4:</span>
<span class="s2">CREATE VIEW </span><span class="s1">detail_transaksi </span><span class="s2">AS</span>
    <span class="s2">SELECT </span><span class="s1">pl</span><span class="s3">.</span><span class="s1">Nama_Pelanggan</span><span class="s3">, </span><span class="s1">pg</span><span class="s3">.</span><span class="s1">Nama_Pegawai</span><span class="s3">, </span><span class="s2">COUNT</span><span class="s3">(</span><span class="s1">ps</span><span class="s3">.</span><span class="s1">ID_Sparepart</span><span class="s3">) </span><span class="s2">AS </span><span class="s1">Jumlah_Sparepart</span><span class="s3">, </span><span class="s2">COUNT</span><span class="s3">(</span><span class="s1">psv</span><span class="s3">.</span><span class="s1">ID_Service</span><span class="s3">) </span><span class="s2">AS </span><span class="s1">Jumlah_Service</span><span class="s3">, </span><span class="s1">t</span><span class="s3">.</span><span class="s1">Tanggal_Pembelian</span>
    <span class="s2">FROM </span><span class="s1">Pelanggan pl</span>
    <span class="s2">INNER JOIN </span><span class="s1">Transaksi t </span><span class="s2">ON </span><span class="s1">pl</span><span class="s3">.</span><span class="s1">ID_Pelanggan = t</span><span class="s3">.</span><span class="s1">ID_Pelanggan</span>
    <span class="s2">INNER JOIN </span><span class="s1">Header_Transaksi ht </span><span class="s2">ON </span><span class="s1">t</span><span class="s3">.</span><span class="s1">ID_Transaksi = ht</span><span class="s3">.</span><span class="s1">ID_Transaksi</span>
    <span class="s2">INNER JOIN </span><span class="s1">Pegawai pg </span><span class="s2">ON </span><span class="s1">ht</span><span class="s3">.</span><span class="s1">ID_Pegawai = pg</span><span class="s3">.</span><span class="s1">ID_Pegawai</span>
    <span class="s2">INNER JOIN </span><span class="s1">Pembelian_Sparepart ps </span><span class="s2">ON </span><span class="s1">t</span><span class="s3">.</span><span class="s1">ID_Transaksi = ps</span><span class="s3">.</span><span class="s1">ID_Transaksi</span>
    <span class="s2">INNER JOIN </span><span class="s1">Pembelian_Service psv </span><span class="s2">ON </span><span class="s1">t</span><span class="s3">.</span><span class="s1">ID_Transaksi = psv</span><span class="s3">.</span><span class="s1">ID_Transaksi</span>
    <span class="s2">GROUP BY </span><span class="s1">t</span><span class="s3">.</span><span class="s1">ID_Transaksi</span><span class="s3">;</span>
<span class="s2">SELECT </span><span class="s1">* </span><span class="s2">FROM </span><span class="s1">detail_transaksi</span><span class="s3">;</span>

</pre>
</body>
</html>